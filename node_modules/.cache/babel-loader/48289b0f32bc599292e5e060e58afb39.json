{"ast":null,"code":"import { logout, login, getAuthInfo } from \"../components/api/api\";\nimport { stopSubmit } from \"redux-form\";\nconst GET_AUTH = 'GET_AUTH';\nconst LOGOUT = 'LOGOUT';\nconst initialState = {\n  id: null,\n  login: '',\n  email: '',\n  isAuth: false\n};\n\nconst authReducer = (state = initialState, action) => {\n  switch (action.type) {\n    case GET_AUTH:\n      return { ...state,\n        ...action.authInfo,\n        isAuth: true\n      };\n\n    case LOGOUT:\n      return { ...state,\n        isAuth: false,\n        id: null,\n        login: '',\n        email: ''\n      };\n\n    default:\n      return state;\n  }\n};\n\nconst getAuth = authInfo => ({\n  type: GET_AUTH,\n  authInfo\n});\n\nconst logoutAC = () => ({\n  type: LOGOUT\n});\n\nexport const getAuthThunk = () => dispatch => {\n  getAuthInfo().then(response => {\n    if (response.data.resultCode === 0) {\n      dispatch(getAuth(response.data.data));\n    }\n  });\n};\nexport const logoutThunk = () => dispatch => {\n  logout().then(response => {\n    if (response.data.resultCode === 0) dispatch(logoutAC());\n  });\n};\nexport const loginThunk = (email, password, rememberMe) => dispatch => {\n  login(email, password, rememberMe).then(response => {\n    if (response.data.resultCode === 0) dispatch(getAuth({\n      email,\n      id: response.data.data.userId\n    }));else {\n      let message = response.data.messages.length > 0 ? response.data.messages[0] : \"some error\";\n      dispatch(stopSubmit(\"login\", {\n        _error: message\n      }));\n    }\n  });\n};\nexport default authReducer;","map":{"version":3,"sources":["/Users/a000/Desktop/react-soc-2/my-react-app/src/redux/auth-reducer.js"],"names":["logout","login","getAuthInfo","stopSubmit","GET_AUTH","LOGOUT","initialState","id","email","isAuth","authReducer","state","action","type","authInfo","getAuth","logoutAC","getAuthThunk","dispatch","then","response","data","resultCode","logoutThunk","loginThunk","password","rememberMe","userId","message","messages","length","_error"],"mappings":"AAAA,SAASA,MAAT,EAAiBC,KAAjB,EAAwBC,WAAxB,QAA2C,uBAA3C;AACA,SAASC,UAAT,QAA2B,YAA3B;AAEA,MAAMC,QAAQ,GAAG,UAAjB;AACA,MAAMC,MAAM,GAAG,QAAf;AAEA,MAAMC,YAAY,GAAG;AACjBC,EAAAA,EAAE,EAAE,IADa;AAEjBN,EAAAA,KAAK,EAAE,EAFU;AAGjBO,EAAAA,KAAK,EAAE,EAHU;AAIjBC,EAAAA,MAAM,EAAE;AAJS,CAArB;;AAOA,MAAMC,WAAW,GAAG,CAACC,KAAK,GAAGL,YAAT,EAAuBM,MAAvB,KAAkC;AAElD,UAAQA,MAAM,CAACC,IAAf;AACI,SAAKT,QAAL;AACI,aAAO,EAAE,GAAGO,KAAL;AAAY,WAAGC,MAAM,CAACE,QAAtB;AAAgCL,QAAAA,MAAM,EAAE;AAAxC,OAAP;;AACJ,SAAKJ,MAAL;AACI,aAAO,EAAE,GAAGM,KAAL;AAAYF,QAAAA,MAAM,EAAE,KAApB;AAA2BF,QAAAA,EAAE,EAAE,IAA/B;AAAqCN,QAAAA,KAAK,EAAE,EAA5C;AAAgDO,QAAAA,KAAK,EAAE;AAAvD,OAAP;;AACJ;AAAS,aAAOG,KAAP;AALb;AAOH,CATD;;AAWA,MAAMI,OAAO,GAAID,QAAD,KAAe;AAC3BD,EAAAA,IAAI,EAAET,QADqB;AAE3BU,EAAAA;AAF2B,CAAf,CAAhB;;AAKA,MAAME,QAAQ,GAAG,OAAO;AACpBH,EAAAA,IAAI,EAAER;AADc,CAAP,CAAjB;;AAIA,OAAO,MAAMY,YAAY,GAAG,MAAOC,QAAD,IAAc;AAE5ChB,EAAAA,WAAW,GAAGiB,IAAd,CAAmBC,QAAQ,IAAI;AAC3B,QAAIA,QAAQ,CAACC,IAAT,CAAcC,UAAd,KAA6B,CAAjC,EAAoC;AAChCJ,MAAAA,QAAQ,CAACH,OAAO,CAACK,QAAQ,CAACC,IAAT,CAAcA,IAAf,CAAR,CAAR;AACH;AACJ,GAJD;AAKH,CAPM;AASP,OAAO,MAAME,WAAW,GAAG,MAAOL,QAAD,IAAc;AAC3ClB,EAAAA,MAAM,GAAGmB,IAAT,CAAcC,QAAQ,IAAI;AACtB,QAAIA,QAAQ,CAACC,IAAT,CAAcC,UAAd,KAA6B,CAAjC,EAAoCJ,QAAQ,CAACF,QAAQ,EAAT,CAAR;AACvC,GAFD;AAGH,CAJM;AAMP,OAAO,MAAMQ,UAAU,GAAG,CAAChB,KAAD,EAAQiB,QAAR,EAAkBC,UAAlB,KAAkCR,QAAD,IAAc;AAGrEjB,EAAAA,KAAK,CAACO,KAAD,EAAQiB,QAAR,EAAkBC,UAAlB,CAAL,CAAmCP,IAAnC,CAAwCC,QAAQ,IAAI;AAChD,QAAIA,QAAQ,CAACC,IAAT,CAAcC,UAAd,KAA6B,CAAjC,EAAoCJ,QAAQ,CAACH,OAAO,CAAC;AAAEP,MAAAA,KAAF;AAASD,MAAAA,EAAE,EAAEa,QAAQ,CAACC,IAAT,CAAcA,IAAd,CAAmBM;AAAhC,KAAD,CAAR,CAAR,CAApC,KACK;AACD,UAAIC,OAAO,GAAGR,QAAQ,CAACC,IAAT,CAAcQ,QAAd,CAAuBC,MAAvB,GAAgC,CAAhC,GAAoCV,QAAQ,CAACC,IAAT,CAAcQ,QAAd,CAAuB,CAAvB,CAApC,GAAgE,YAA9E;AACAX,MAAAA,QAAQ,CAACf,UAAU,CAAC,OAAD,EAAU;AAAE4B,QAAAA,MAAM,EAAEH;AAAV,OAAV,CAAX,CAAR;AACH;AACJ,GAND;AAOH,CAVM;AAYP,eAAelB,WAAf","sourcesContent":["import { logout, login, getAuthInfo } from \"../components/api/api\"\nimport { stopSubmit } from \"redux-form\"\n\nconst GET_AUTH = 'GET_AUTH'\nconst LOGOUT = 'LOGOUT'\n\nconst initialState = {\n    id: null,\n    login: '',\n    email: '',\n    isAuth: false\n}\n\nconst authReducer = (state = initialState, action) => {\n\n    switch (action.type) {\n        case GET_AUTH:\n            return { ...state, ...action.authInfo, isAuth: true }\n        case LOGOUT:\n            return { ...state, isAuth: false, id: null, login: '', email: '' }\n        default: return state\n    }\n}\n\nconst getAuth = (authInfo) => ({\n    type: GET_AUTH,\n    authInfo\n})\n\nconst logoutAC = () => ({\n    type: LOGOUT\n})\n\nexport const getAuthThunk = () => (dispatch) => {\n    \n    getAuthInfo().then(response => {\n        if (response.data.resultCode === 0) {\n            dispatch(getAuth(response.data.data))\n        }\n    })\n}\n\nexport const logoutThunk = () => (dispatch) => {\n    logout().then(response => {\n        if (response.data.resultCode === 0) dispatch(logoutAC())\n    })\n}\n\nexport const loginThunk = (email, password, rememberMe) => (dispatch) => {\n\n\n    login(email, password, rememberMe).then(response => {\n        if (response.data.resultCode === 0) dispatch(getAuth({ email, id: response.data.data.userId }))\n        else {\n            let message = response.data.messages.length > 0 ? response.data.messages[0] : \"some error\"\n            dispatch(stopSubmit(\"login\", { _error: message }))\n        }\n    })\n}\n\nexport default authReducer"]},"metadata":{},"sourceType":"module"}